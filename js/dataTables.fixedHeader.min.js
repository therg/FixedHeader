!function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,o){return t||(t=window),o&&o.fn.dataTable||(o=require("datatables.net")(t,o).$),e(o,t,t.document)}:e(jQuery,window,document)}(function(e,t,o,i){"use strict";var n=e.fn.dataTable,d=0,a=function(o,i){if(!(this instanceof a))throw"FixedHeader must be initialised with the 'new' keyword.";!0===i&&(i={}),o=new n.Api(o),this.c=e.extend(!0,{},a.defaults,i),this.s={dt:o,position:{theadTop:0,tbodyTop:0,tfootTop:0,tfootBottom:0,width:0,left:0,tfootHeight:0,theadHeight:0,windowHeight:e(t).height(),visible:!0,wrapperWidth:0},headerMode:null,footerMode:null,autoWidth:o.settings()[0].oFeatures.bAutoWidth,namespace:".dtfc"+d++,scrollLeft:{header:-1,footer:-1},enable:!0},this.dom={floatingHeader:null,thead:e(o.table().header()),tbody:e(o.table().body()),tfoot:e(o.table().footer()),header:{host:null,floating:null,placeholder:null,prepend:null},footer:{host:null,floating:null,placeholder:null,prepend:null}},this.dom.header.host=this.dom.thead.parent(),this.dom.footer.host=this.dom.tfoot.parent();var s=o.settings()[0];if(s._fixedHeader)throw"FixedHeader already initialised on table "+s.nTable.id;s._fixedHeader=this,this._constructor()};return e.extend(a.prototype,{enable:function(e){this.s.enable=e,this.c.header&&this._modeChange("in-place","header",!0),this.c.footer&&this.dom.tfoot.length&&this._modeChange("in-place","footer",!0),this.update()},headerOffset:function(e){return e!==i&&(this.c.headerOffset=e,this.update()),this.c.headerOffset},footerOffset:function(e){return e!==i&&(this.c.footerOffset=e,this.update()),this.c.footerOffset},update:function(){this._positions(),this._scroll(!0)},_constructor:function(){var o=this,i=this.s.dt;e(t).on("scroll"+this.s.namespace,function(){o._scroll()}).on("resize"+this.s.namespace,function(){o.s.position.windowHeight=e(t).height(),o.update()});var n=e(".fh-fixedHeader");!this.c.headerOffset&&n.length&&(this.c.headerOffset=n.outerHeight());var d=e(".fh-fixedFooter");!this.c.footerOffset&&d.length&&(this.c.footerOffset=d.outerHeight()),i.on("column-reorder.dt.dtfc column-visibility.dt.dtfc draw.dt.dtfc column-sizing.dt.dtfc",function(o){e(t).trigger("resize")}),i.on("destroy.dtfc",function(){i.off(".dtfc"),e(t).off(o.s.namespace)}),this._positions(),this._scroll()},_clone:function(t,o){var i=this.s.dt,n=this.dom[t],d="header"===t?this.dom.thead:this.dom.tfoot;if(this.c.beforeCloneCallback(o,n.floating),!o&&n.floating)n.floating.removeClass("fixedHeader-floating fixedHeader-locked");else if(!0===o&&n.floating){var a=n.floating.find("table");a.children().detach(),a.remove(),n.placeholder.remove(),this._unsize(t),e(i.table().node().cloneNode(!1)).css("table-layout","fixed").removeAttr("id").append(d).appendTo(n.floating),n.placeholder=d.clone(!1),n.placeholder.find("*[id]").removeAttr("id"),n.host.prepend(n.placeholder),this._matchWidths(n.placeholder,n.floating)}else{if(n.floating&&(n.placeholder.remove(),this._unsize(t),n.floating.children().detach(),n.floating.remove(),n.prepend&&!o&&n.prepend.remove()),n.floating=e('<div class="fixedHeader-floating-wrapper"></div>'),n.floating.append(e(i.table().node().cloneNode(!1)).css("table-layout","fixed").removeAttr("id").append(d)).appendTo("body"),this.c.prependSelector){var s=e(i.settings()[0].nTableWrapper).find(this.c.prependSelector);s.length&&(n.prepend=s.clone(!0),n.floating.prepend(n.prepend))}n.placeholder=d.clone(!1),n.placeholder.find("*[id]").removeAttr("id"),n.host.prepend(n.placeholder),this._matchWidths(n.placeholder,n.floating)}},_matchWidths:function(t,o){var i=function(o){return e(o,t).map(function(){return e(this).width()}).toArray()},n=function(t,i){e(t,o).each(function(t){e(this).css({width:i[t],minWidth:i[t]})})},d=i("th"),a=i("td");n("th",d),n("td",a)},_unsize:function(t){var o=this.dom[t].floating;o&&("footer"===t||"header"===t&&!this.s.autoWidth)?e("th, td",o).css({width:"",minWidth:""}):o&&"header"===t&&e("th, td",o).css("min-width","")},_horizontal:function(e,t){var o=this.dom[e],i=this.s.position,n=this.s.scrollLeft;o.floating&&n[e]!==t&&(o.floating.css("left",i.left-t),n[e]=t)},_modeChange:function(t,i,n){var d=this.s.dt,a=this.dom[i],s=this.s.position,r=this.dom["footer"===i?"tfoot":"thead"],f=e.contains(r[0],o.activeElement)?o.activeElement:null;"in-place"===t?(a.placeholder&&(a.placeholder.remove(),a.placeholder=null),"header"===i?a.host.prepend(this.dom.thead):a.host.append(this.dom.tfoot),a.floating&&(this.c.beforeFixedRemoved(a.floating),a.floating.remove(),a.floating=null),this.c.inplaceCallback(e(d.settings()[0].nTableWrapper))):"in"===t?(this._clone(i,n),a.floating.addClass("fixedHeader-floating").css("header"===i?"top":"bottom",this.c[i+"Offset"]).css("left",s.left+"px").css("width",s.width+"px"),"footer"===i&&a.floating.css("top",""),this.c.fixedCallback(e(d.settings()[0].nTableWrapper),a.floating)):"below"===t?(this._clone(i,n),a.floating.addClass("fixedHeader-locked").css("top",s.tfootTop-s.theadHeight).css("left",s.left+"px").css("width",s.width+"px")):"above"===t&&(this._clone(i,n),a.floating.addClass("fixedHeader-locked").css("top",s.tbodyTop).css("left",s.left+"px").css("width",s.width+"px")),f&&f!==o.activeElement&&f.focus(),this.s.scrollLeft.header=-1,this.s.scrollLeft.footer=-1,this.s[i+"Mode"]=t},_positions:function(){var t=this.s.dt,o=t.table(),i=this.s.position,n=this.dom,d=e(o.node()),a=e(t.settings()[0].nTableWrapper),s=d.children("thead"),r=d.children("tfoot"),f=n.tbody;if("wrapper"==this.c.positionVia)l=a;else var l=d;if(this.c.prependSelector)h=a.find(this.c.prependSelector);else var h=s;i.visible=d.is(":visible"),i.width=l.outerWidth(),i.left=l.offset().left,i.theadTop=h.offset().top,i.tbodyTop=f.offset().top,i.theadHeight=i.tbodyTop-i.theadTop,r.length?(i.tfootTop=r.offset().top,i.tfootBottom=i.tfootTop+r.outerHeight(),i.tfootHeight=i.tfootBottom-i.tfootTop):(i.tfootTop=i.tbodyTop+f.outerHeight(),i.tfootBottom=i.tfootTop,i.tfootHeight=i.tfootTop)},_scroll:function(t){var i,n,d=e(o).scrollTop(),a=e(o).scrollLeft(),s=this.s.position;if(this.s.enable){if(this.c.header){if(i=!s.visible||d<=s.theadTop-this.c.headerOffset?"in-place":d<=s.tfootTop-s.theadHeight-this.c.headerOffset?"in":"below",t||i!==this.s.headerMode){var r=this.s.headerMode,f=i;this._modeChange(i,"header",t),null!==r&&null!==f&&r!==f&&this.c.positionChangeCallback(r,f)}this.c.horizontalPos&&this._horizontal("header",a)}this.c.footer&&this.dom.tfoot.length&&(n=!s.visible||d+s.windowHeight>=s.tfootBottom+this.c.footerOffset?"in-place":s.windowHeight+d>s.tbodyTop+s.tfootHeight+this.c.footerOffset?"in":"above",(t||n!==this.s.footerMode)&&this._modeChange(n,"footer",t),this.c.horizontalPos&&this._horizontal("footer",a))}}}),a.version="3.1.3-dev",a.defaults={header:!0,footer:!1,headerOffset:0,footerOffset:0,positionVia:"table",prependSelector:null,horizontalPos:!0,fixedCallback:e.noop,inplaceCallback:e.noop,beforeFixedRemoved:e.noop,positionChangeCallback:e.noop,beforeCloneCallback:e.noop},e.fn.dataTable.FixedHeader=a,e.fn.DataTable.FixedHeader=a,e(o).on("init.dt.dtfh",function(t,o,i){if("dt"===t.namespace){var d=o.oInit.fixedHeader,s=n.defaults.fixedHeader;if((d||s)&&!o._fixedHeader){var r=e.extend({},s,d);!1!==d&&new a(o,r)}}}),n.Api.register("fixedHeader()",function(){}),n.Api.register("fixedHeader.adjust()",function(){return this.iterator("table",function(e){var t=e._fixedHeader;t&&t.update()})}),n.Api.register("fixedHeader.enable()",function(e){return this.iterator("table",function(t){var o=t._fixedHeader;o&&o.enable(e===i||e)})}),n.Api.register("fixedHeader.disable()",function(){return this.iterator("table",function(e){var t=e._fixedHeader;t&&t.enable(!1)})}),e.each(["header","footer"],function(e,t){n.Api.register("fixedHeader."+t+"Offset()",function(e){var o=this.context;return e===i?o.length&&o[0]._fixedHeader?o[0]._fixedHeader[t+"Offset"]():i:this.iterator("table",function(o){var i=o._fixedHeader;i&&i[t+"Offset"](e)})})}),a});
